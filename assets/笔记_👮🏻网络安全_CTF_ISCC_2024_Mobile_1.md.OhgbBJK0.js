import{_ as l,c as e,J as s,V as p,m as i,a as h,o as k,E as a}from"./chunks/framework.WH0rnJL5.js";const r="/assets/image-20240503011204183.cm0sMHsr.png",d="/assets/image-20240503011053127.2pArI9Hq.png",c="/assets/image-20240503011347998.ANtwdV2s.png",o="/assets/image-20240503011528435.4M7px3HI.png",u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"ç¬”è®°/ğŸ‘®ğŸ»ç½‘ç»œå®‰å…¨/CTF/ISCC/2024/Mobile_1.md","filePath":"ç¬”è®°/ğŸ‘®ğŸ»ç½‘ç»œå®‰å…¨/CTF/ISCC/2024/Mobile_1.md"}'),g={name:"ç¬”è®°/ğŸ‘®ğŸ»ç½‘ç»œå®‰å…¨/CTF/ISCC/2024/Mobile_1.md"},y=p(`<h2 id="mobile-1" tabindex="-1">Mobile_1 <a class="header-anchor" href="#mobile-1" aria-label="Permalink to &quot;Mobile_1&quot;">â€‹</a></h2><p>é¦–å…ˆå®‰è£…ä»¥ä¸‹ä¸¤ä¸ªåº“</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>pip install frida</span></span>
<span class="line"><span>pip install frida-server</span></span></code></pre></div><p>å†å®‰è£…é›·ç”µæ¨¡æ‹Ÿå™¨ï¼Œå®‰è£…æˆåŠŸä¹‹åã€‚ä¿®æ”¹æ¨¡æ‹Ÿå™¨æƒé™å¢åŠ ROOTã€‚</p><p><img src="`+r+'" alt="image-20240503011204183"></p><p>è¿›å…¥é›·ç”µæ¨¡æ‹Ÿå™¨çš„ç›®å½•<code>xxx\\leidian\\LDPlayer9</code>,åœ¨è¯¥ç›®å½•ä¸‹æ‰“å¼€cmdï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ¤æ–­adbæ˜¯å¦å¯ä»¥ä½¿ç”¨ã€‚</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>adb devices</span></span></code></pre></div><p><img src="'+d+`" alt="image-20240503011053127"></p><p>ç„¶åå°†<code>frida-server</code>ç§»åŠ¨åˆ°<code>adb push frida-server-16.2.1 /data/local/tmp</code>ç›®å½•ä¸‹.</p><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>adb shell</span></span>
<span class="line"><span>su</span></span>
<span class="line"><span>cd /data/local/tmp</span></span>
<span class="line"><span>./frida-server-16.2.1 &amp;</span></span></code></pre></div><p>åœ¨ä¹‹ååˆ©ç”¨é›·ç”µæ¨¡æ‹Ÿå™¨å®‰è£…apkï¼Œapkå°±æ˜¯é¢˜ç›®æä¾›çš„é™„ä»¶</p><p><img src="`+c+`" alt="image-20240503011347998"></p><p>å®‰è£…æˆåŠŸä¹‹åæ‰“å¼€ï¼Œé¦–å…ˆæ‰§è¡Œä»¥ä¸‹pythonè„šæœ¬</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> frida,sys</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> on_message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">dada</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> message[</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;send&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;[*] </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{0}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(message[</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;payload&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(message)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#hook js</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">jscode </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;&#39;&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Java.perform(function(){</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        var targetClass = Java.use(&#39;com.example.whathappened.a&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        var Receiver = Java.use(&#39;com.example.whathappened.Receiver&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        targetClass.a.implementation = function() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            console.log(&#39;hack&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            var s = &quot;04999999&quot;;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            var s1 = &quot;gwC9nOCNUhsHqZm&quot;;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            var enc = Receiver.encrypt2(Receiver.encrypt(s, s1)).substring(0, 0x20);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            console.log(enc);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    });</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;&#39;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># jscode = &#39;&#39;&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">NolebasePageProperties </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#     Java.perform(function(){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#         var targetClass = Java.use(&#39;com.example.whathappened.a&#39;);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#         var Myjni = Java.use(&#39;com.example.whathappened.MyJNI.Myjni&#39;)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#         targetClass.a.implementation = function() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#             console.log(&#39;hack&#39;);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#             var leak = Myjni.getstr();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#             console.log(leak);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#             return true;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#         }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#     });</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># &#39;&#39;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># å¯åŠ¨æ–¹å¼1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">process </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> frida.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">get_usb_device</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">attach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;Puzzle Game&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">script </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> process.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">create_script</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(jscode)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">script.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, on_message)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">script.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">sys.stdin.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># # å¯åŠ¨æ–¹å¼2 spawn é‡å¯APP å¯ä»¥hook APPå¯åŠ¨é˜¶æ®µ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># device = frida.get_usb_device(-1)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># pid = device.spawn([&#39;3200&#39;])</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># process = device.attach(pid)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># script = process.create_script(test)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># script.on(&#39;message&#39;, on_message)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># script.load()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># device.resume(pid)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># sys.stdin.read()</span></span></code></pre></div><p>åœ¨æ‰“å¼€çš„apkä¸­ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><p><img src="`+o+'" alt="image-20240503011528435"></p><p>ç‚¹å‡»checkï¼Œä¹‹åæŸ¥çœ‹pythonè„šæœ¬çš„å›æ˜¾å°±è¡Œã€‚</p><h2 id="è´¡çŒ®è€…" tabindex="-1">è´¡çŒ®è€… <a class="header-anchor" href="#è´¡çŒ®è€…" aria-label="Permalink to &quot;è´¡çŒ®è€…&quot;">â€‹</a></h2>',19),B=i("h2",{id:"æ–‡ä»¶å†å²",tabindex:"-1"},[h("æ–‡ä»¶å†å² "),i("a",{class:"header-anchor",href:"#æ–‡ä»¶å†å²","aria-label":'Permalink to "æ–‡ä»¶å†å²"'},"â€‹")],-1);function F(A,f,C,m,E,_){const n=a("NolebaseGitContributors"),t=a("NolebaseGitChangelog");return k(),e("div",null,[y,s(n),B,s(t)])}const D=l(g,[["render",F]]);export{u as __pageData,D as default};
